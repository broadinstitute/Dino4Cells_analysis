{"model": {"model_type": "DINO", "arch": "vit_base", "root": "", "data_path": "/mnt/data0/mdoron/HPA_data/whole_images_512.csv", "output_dir": "/home/unix/mdoron/Dino4Cells/supervised_vit_512/", "datatype": "HPA", "image_mode": "normalized_4_channels", "saveckp_freq": 50, "batch_size_per_gpu": 8, "num_channels": 4, "patch_size": 8, "local_crops_scale": "0.2 0.5", "epochs": 100, "momentum_teacher": 0.996, "lr": 0.0005}, "embedding": {"pretrained_weights": "/scr/mdoron/Dino4Cells/models/FAIR_whole_image_all_channels/checkpoint.pth", "output_path": "/scr/mdoron/Dino4Cells/models/FAIR_whole_image_all_channels/features.pth", "df_path": "/scr/mdoron/Dino4Cells/data/whole_images.csv", "image_size": 224, "num_workers": 0, "embedding_has_labels": true, "num_augmentation_repetitions": 0}, "plot_embedding": {"output_name": "/home/unix/mdoron/Dino4Cells/supervised_vit_512/"}, "kaggle_test_data": {"averaged_features": false, "df_path": "/scr/mdoron/Dino4Cells/data/kaggle_whole_image_test_IDs.csv", "pretrained_weights": "/scr/mdoron/Dino4Cells/models/FAIR_whole_image_all_channels/checkpoint.pth", "whole_image_train_features_path": "/scr/mdoron/Dino4Cells/models/FAIR_whole_image_all_channels/features.pth", "whole_image_kaggle_features_path": "/scr/mdoron/Dino4Cells/models/FAIR_whole_image_all_channels/test_features.pth", "whole_image_classifier": "/scr/mdoron/Dino4Cells/models/whole_image_model/protein_classifier.pth", "whole_image_train_statistics": "/scr/mdoron/Dino4Cells/models/whole_image_model/balanced_statistics.npy", "submission_path": "/scr/mdoron/Dino4Cells/models/FAIR_whole_image_all_channels/supervsied_vit_small_16_submission.csv", "num_workers": 0}, "classification": {"early_stopping": -1, "averaged_features_path": "/scr/mdoron/Dino4Cells/models/FAIR_whole_image_all_channels/features.pth", "averaged_train_path": "/scr/mdoron/Dino4Cells/models/FAIR_whole_image_all_channels/train_features.pth", "averaged_valid_path": "/scr/mdoron/Dino4Cells/models/FAIR_whole_image_all_channels/valid_features.pth", "averaged_test_path": "/scr/mdoron/Dino4Cells/models/FAIR_whole_image_all_channels/test_features.pth", "train_path": "/scr/mdoron/Dino4Cells/models/FAIR_whole_image_all_channels/train_features.pth", "valid_path": "/scr/mdoron/Dino4Cells/models/FAIR_whole_image_all_channels/valid_features.pth", "cells_train_path": "/scr/mdoron/Dino4Cells/models/FAIR_whole_image_all_channels/train_features_cells.pth", "cells_valid_path": "/scr/mdoron/Dino4Cells/models/FAIR_whole_image_all_channels/valid_features_cells.pth", "test_path": "/scr/mdoron/Dino4Cells/models/FAIR_whole_image_all_channels/test_features.pth", "whole_image_submission_file": "/scr/mdoron/Dino4Cells/models/FAIR_whole_image_all_channels/whole_image_submission.csv", "competition_type": "whole_images", "use_pretrained_features": true, "prepare_kaggle_submission": false, "train_classifier_head": true, "whole_images": true, "feature_extractor_state_dict": null, "classifier_state_dict": "/scr/mdoron/Dino4Cells/results/FAIR_whole_image_all_channels/classifier_final_protein_whole.pth", "load_classifier_head": false, "train_feature_extractor": false, "epochs": 10, "num_workers": 14, "batch_size_per_gpu": 512, "dropout": 0.5, "lr": 0.0001, "min_lr": "1e-6", "wd": 0.04, "overwrite": true, "wd_end": 0.4, "n_layers": 2, "schedule": "Cosine", "n_units": 1024, "skip": false, "balance": true, "optimizer": "AdamW", "protein_classifier": "/home/unix/mdoron/Dino4Cells/supervised_vit_512/protein_classifier.pth", "cell_type_classifier": "/home/unix/mdoron/Dino4Cells/supervised_vit_512/cell_type_classifier.pth", "classifier_type": "residual_add_clf", "num_classes": 28, "loss": "BCEWithLogitsLoss", "train_statistics": "/home/unix/mdoron/Dino4Cells/supervised_vit_512/balanced_statistics.npy", "protein_task": "full", "use_pretrained_cell_type_classifier": false, "use_pretrained_protein_classifier": false, "averaged_features": "/home/unix/mdoron/Dino4Cells/supervised_vit_512/features.pth", "training_features_paths_list": ["/home/unix/mdoron/Dino4Cells/supervised_vit_512/features.pth"], "train_protein": true, "train_cell_type": false, "verbose": true, "output_dir": "/scr/mdoron/Dino4Cells/results/", "output_prefix": "FAIR_whole_image_all_channels"}, "visualize": {"image_path": "/mnt/data0/mdoron/Dino4Cells/datasets/HPA/data/75112_1646_F7_1_blue.jpg"}, "flip_and_color_jitter_transforms": {"RandomRotation": [false, {"degrees": 90, "expand": false}], "RandomHorizontalFlip": [true, {"p": 0.5}], "RandomVerticalFlip": [true, {"p": 0.5}], "Change_brightness": [true, {"p": 0.5}], "Change_contrast": [true, {"p": 0.5}], "GaussianBlur": [false, {"p": 1.0}], "ColorJitter": [false, {"brightness": 0.4, "contrast": 0.4, "saturation": 0.2, "hue": 0.1}], "ColorJitter_for_RGBA": [false, {"brightness": 0.4, "contrast": 0.4, "saturation": 0.2, "hue": 0.1}]}, "normalization": {"Get_specific_channel": [false, {"c": 3}], "ToTensor": [true, null], "Normalize": [true, {"mean": [0.1450534, 0.11360057, 0.1231717, 0.14919987], "std": [0.18122554, 0.14004277, 0.18840286, 0.17790672]}], "self_normalize": [false, null]}, "global_transfo1": {"Warp_cell": [true, null], "Single_cell_centered": [false, null], "Single_cell_random_resize": [false, null], "FA_resize": [false, {"size": 512}], "Single_cell_Resize": [false, null], "Single_cell_Mirror": [false, null], "remove_channel": [false, {"p": 0.2}], "rescale_protein": [true, {"p": 0.2}], "RandomResizedCrop": [true, {"size": 224, "scale": [0.4, 1]}], "Threshold_protein": [false, {"p": 0.8, "interpolation": "Image.BICUBIC"}], "RandomResizedCenterCrop": [false, {"size": 224, "scale": [0.5, 1], "depth": "1e6", "s": 0.7}]}, "global_aug1": {"GaussianBlur": [false, {"p": 1.0}], "Solarization": [false, {"p": 0.2}], "Solarization_for_RGBA": [false, {"p": 0.2}], "rnd_dihedral": [false, null]}, "testing_transfo": {"Single_cell_centered": [false, null], "Single_cell_random_resize": [false, null], "FA_resize": [false, {"size": 512}], "Single_cell_Resize": [false, null], "Single_cell_Mirror": [false, null], "Get_specific_channel": [false, {"c": 3}], "ToTensor": [true, null], "Normalize": [false, {"mean": [0.1450534, 0.11360057, 0.1231717, 0.14919987], "std": [0.18122554, 0.14004277, 0.18840286, 0.17790672]}], "self_normalize": [true, null]}, "global_transfo2": {"Warp_cell": [false, null], "Single_cell_centered": [false, null], "Single_cell_random_resize": [false, null], "FA_resize": [false, {"size": 512}], "Single_cell_Resize": [false, null], "Single_cell_Mirror": [false, null], "remove_channel": [true, {"p": 0.2}], "rescale_protein": [true, {"p": 0.2}], "RandomResizedCrop": [true, {"size": 224, "scale": [0.4, 1]}], "Threshold_protein": [false, {"p": 0.8, "interpolation": "Image.BICUBIC"}], "RandomResizedCenterCrop": [false, {"size": 224, "scale": [0.4, 1], "depth": "1e6", "s": 0.7}]}, "global_aug2": {"GaussianBlur": [false, {"p": 1.0}], "Solarization": [false, {"p": 0.2}], "Solarization_for_RGBA": [false, {"p": 0.2}], "rnd_dihedral": [false, null]}, "local_crops_number": 8, "local_transfo": {"Warp_cell": [false, null], "Single_cell_centered": [false, null], "Single_cell_random_resize": [false, null], "FA_resize": [false, {"size": 512}], "Single_cell_Resize": [false, null], "Single_cell_Mirror": [false, null], "remove_channel": [true, {"p": 0.2}], "rescale_protein": [true, {"p": 0.2}], "RandomResizedCrop": [true, {"size": 96, "scale": [0.05, 0.4]}], "Threshold_protein": [false, {"p": 0.8, "interpolation": "Image.BICUBIC"}], "RandomResizedCenterCrop": [false, {"size": 96, "scale": [0.2, 0.5], "depth": "1e6", "s": 0.7}]}, "local_aug": {"GaussianBlur": [false, {"p": 1.0}], "rnd_dihedral": [false, null]}, "pipeline": {"run_DINO": false, "run_get_features": true, "run_plot_embeddings": false, "run_classification": false, "run_visualize": false, "run_get_features_kaggle": false, "run_classify_kaggle_test": false}, "command_lind_args": {"checkpoint_frq": 50, "checksize": 3, "check_batch": null, "test_last": false, "train": "True", "test": "True", "dist_url": "env://", "epochs": "100", "balance": "True", "num_classes": "28", "train_cell_type": "False", "train_protein": "True", "parallel_training": false}}